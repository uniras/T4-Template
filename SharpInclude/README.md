SharpInclude    ソースコード取り込みテンプレート
====

概要
----

SharpTemplateは、その名の通りソースコードを取り込んで出力するテンプレートです。

プロジェクトのコードをT4の処理で使いたい時や、共通するコードを特定の部分に差し込みたい時などに使います。

単純にファイルを取り込むと余計な物をいろいろ取り込んでしまうので(というかそれでいいならincludeディレクティブを使いましょう)、

ソースコードを解析してクラスやメソッドだけを取り込むようになっています、取り込む範囲を明示的に指定することもできます。

そのまま出力することはもちろん、T4内で使うための機能ブロックの形で出力することも出来ます。

機能ブロックとして出力する際にはusingディレクティブを解析してT4のimportディレクティブに変換したコードも併せて出力します。


インストール
----

SharpInclude.t4をプロジェクトに追加するだけです。


使い方
----

テンプレートを次のように記述します。

    <#@ template debug="false" hostspecific="true" language="C#" #>
    <#@ include file="SharpInclude.t4" #>
	<#@ output extension=".t4" #>
    <#= SharpInclude("取り込みたいファイル") #>

これで取り込みたいファイルにある全てのコードがT4の機能ブロックとして出力されますので、includeすることでT4内で利用することが出来るようになります。

全てのメソッド、特定のクラスまたはメソッドを指定して取り込むことも出来ます。

また、取り込まれる元のファイルに取り込みたい範囲を```//<++ ～ //++>```で囲むことで取り込む範囲を個別に指定することが出来ます。

範囲を複数指定することは可能ですが、入れ子にすると正しく取り込みません。


リファレンス
----

SharpIncludeで利用できるメソッドは次の通りです。

戻り値は全てstring型になっていますので、式コントロールブロック(```<#= ～ #>```)で呼び出すことで結果がそのまま出力されます。

>string SharpInclude(string file, string name, bool inusing)

ファイルから全てのクラスのコードもしくは指定したクラスのコードを機能ブロックとして取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br/>
name - どのクラスを取り込むのかを文字列で指定します。空文字列を渡すもしくは指定しないと全て取り込みます。<br/>
inusing - usingディレクティブを解析してimportディレクティブを出力するかどうかを指定します。指定しないとusingディレクティブを解析して出力します。


>string SharpIncludeList(params string[] files)

複数のファイルの全てのクラスのコードを機能ブロックとして取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpMixin(string file, string name)

ファイルから全てのクラスのコードもしくは指定したクラスをそのまま取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br />
name - どのクラス取り込むのかを文字列で指定します。空文字列を渡すもしくは指定しないと全て取り込みます。


>string SharpMixinList(params string[] files)

複数のファイルの全てのクラスのコードをそのまま取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpIncludeMethod(string file, string name, bool inusing)

ファイルから全てのメソッドのコードもしくは指定したメソッドのコードを機能ブロックとして取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br/>
name - どのメソッド取り込むのかを文字列で指定します。空文字列を渡すもしくは指定しないと全て取り込みます。<br/>
inusing - usingディレクティブを解析してimportディレクティブを出力するかどうかを指定します。指定しないとusingディレクティブを解析して出力します。


>string SharpIncludeMethodList(params string[] files)

複数のファイルの全てのメソッドのコードを機能ブロックとして取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpMixinMethod(string file, string name)

ファイルから全てのメソッドのコードもしくは指定したメソッドをそのまま取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br />
name - どのメソッドを取り込むのかを文字列で指定します。空文字列を渡すもしくは指定しないと全て取り込みます。


>string SharpMixinMethodList(params string[] files)

複数のファイルの全てのクラスのコードをそのまま取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpIncludeBlock(string file, int pos, bool inusing)

取り込む元のファイルで個別に指定した範囲のコードの全てもしくは一部を機能ブロックとして取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br/>
pos - 範囲が複数指定されている時に何番目を取り込むのかを0オリジン(pos+1番目)で指定します。負の値を渡すもしくは指定しないと全て取り込みます。<br/>
inusing - usingディレクティブを解析してimportディレクティブを出力するかどうかを指定します。指定しないとusingディレクティブを解析して出力します。


>string SharpIncludeBlockList(params string[] files)

複数のファイルでそれぞれ個別に指定した範囲のコードを全て機能ブロックとして取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpMixinBlock(string file, int pos)

取り込む元のファイルで個別に指定した範囲のコードの全てもしくは一部をそのまま取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br />
pos - 範囲が複数指定されている時に何番目を取り込むのかを0オリジン(pos+1番目)で指定します。負の値を渡すもしくは指定しないと全て取り込みます。


>string SharpMixinBlockList(params string[] files)

複数のファイルでそれぞれ個別に指定した範囲のコードを全てそのまま取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


ライセンス
-----

NYSLです

http://www.kmonos.net/nysl/