SharpInclude    ソースコード取り込みテンプレート
====

概要
----

SharpTemplateは、その名の通りソースコードを取り込んで出力するテンプレートです。

プロジェクトのコードをT4の処理で使いたい時や、共通するコードを特定の部分に差し込みたい時などに使います。

単純にファイルを取り込むと余計な物をいろいろ取り込んでしまうので(というかそれでいいならincludeディレクティブがあります)、

取り込む元のファイル内で明示的に指定した範囲だけを取り込むようになっています。

そのまま出力することはもちろん、T4内で使うための機能ブロックやコントロールブロックになった形で出力することも出来ます。

機能ブロックやコントロールブロックとして出力する際にはC#のusingディレクティブを解析してT4のimportディレクティブに変換したコードも併せて出力します。


インストール
----

SharpInclude.t4をプロジェクトに追加するだけです。


使い方
----

取り込まれる元のファイルに取り込みたい範囲を

```//<** ～ //**>```(ディレクティブやテンプレートとして出力する範囲)<br />
```//<-- ～ //-->```(コントロールブロックとして出力する範囲)<br />
```//<++ ～ //++>```(機能ブロックとして出力する範囲)

で囲むことで取り込む範囲を個別に指定します。

範囲を複数指定することは可能ですが、入れ子にすると正しく取り込みません。

テンプレートを次のように記述します。

    <#@ template debug="false" hostspecific="true" language="C#" #>
    <#@ include file="SharpInclude.t4" #>
	<#@ output extension=".t4" #>
    <#= SharpInclude.Include("取り込みたいファイル") #>

これで、取り込みたいファイルで指定した範囲のコードが機能ブロックまたはコントロールブロックとして出力されます。

//<(\*\*/--/++)のすぐ右(スペース等を挟まず)に文字列を記述することでブロックに名前をつけることができ、特定の名前がついたブロックだけ取り込むこともできます。

リファレンス
----

SharpIncludeで利用できるメソッドは次の通りです。

戻り値は全てstring型になっていますので、式コントロールブロック(```<#= ～ #>```)で呼び出すことで結果がそのまま出力されます。


>string SharpInclude.Include(string file, string pos, bool inusing)

取り込む元のファイルで個別に指定した範囲のコードの全てもしくは一部を機能ブロックまたはコントロールブロックとして取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。指定しないとT4の処理対象になっているテンプレートファイル(Host.TemplateFile)を指定したことになります。<br />
pos - 指定した名前のブロックだけを取り込みます。空文字列を渡すもしくは指定しないと全てのブロックを取り込みます。先頭に+-*をつけるとブロックの種類を限定でき、先頭に$をつけるとクラスを取り込むことが出来ます。<br />
inusing - usingディレクティブを解析してimportディレクティブを出力するかどうかを指定します。指定しないとusingディレクティブを解析して出力します。


>string SharpInclude.IncludeList(params string[] files)

複数のファイルでそれぞれ個別に指定した範囲のコードを全て機能ブロックまたはコントロールブロックとして取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


>string SharpInclude.Mixin(string file, int pos)

取り込む元のファイルで個別に指定した範囲のコードの全てもしくは一部をそのまま取り込みます。

file - 取り込むファイル名を指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。<br />
pos - 指定した名前のブロックだけを取り込みます。空文字列を渡すもしくは指定しないと全てのブロックを取り込みます。先頭に+-*をつけるとブロックの種類を限定でき、先頭に$をつけるとクラスを取り込むことが出来ます。


>string SharpInclude.MixinList(params string[] files)

複数のファイルでそれぞれ個別に指定した範囲のコードを全てそのまま取り込みます。

files - 取り込むファイルをカンマ(,)で区切って複数指定します。呼び出し元のテンプレートファイルのパスを基準とした相対パスが使えます。


ライセンス
-----

NYSLです

http://www.kmonos.net/nysl/